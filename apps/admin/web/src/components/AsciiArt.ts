const ALPHABET: Record<string, string[]> = {
  A: [" █████╗ ", "██╔══██╗", "███████║", "██╔══██║", "██║  ██║", "╚═╝  ╚═╝"],
  B: ["██████╗ ", "██╔══██╗", "██████╔╝", "██╔══██╗", "██████╔╝", "╚═════╝ "],
  C: [" ██████╗", "██╔════╝", "██║     ", "██║     ", "╚██████╗", " ╚═════╝"],
  D: ["██████╗ ", "██╔══██╗", "██║  ██║", "██║  ██║", "██████╔╝", "╚═════╝ "],
  E: ["███████╗", "██╔════╝", "█████╗  ", "██╔══╝  ", "███████╗", "╚══════╝"],
  F: ["███████╗", "██╔════╝", "█████╗  ", "██╔══╝  ", "██║     ", "╚═╝     "],
  G: [
    " ██████╗ ",
    "██╔════╝ ",
    "██║  ███╗",
    "██║   ██║",
    "╚██████╔╝",
    " ╚═════╝ ",
  ],
  H: ["██╗  ██╗", "██║  ██║", "███████║", "██╔══██║", "██║  ██║", "╚═╝  ╚═╝"],
  I: ["██╗", "██║", "██║", "██║", "██║", "╚═╝"],
  J: ["     ██╗", "     ██║", "     ██║", "██   ██║", "╚█████╔╝", " ╚════╝ "],
  K: ["██╗  ██╗", "██║ ██╔╝", "█████╔╝ ", "██╔═██╗ ", "██║  ██╗", "╚═╝  ╚═╝"],
  L: ["██╗     ", "██║     ", "██║     ", "██║     ", "███████╗", "╚══════╝"],
  M: [
    "███╗   ███╗",
    "████╗ ████║",
    "██╔████╔██║",
    "██║╚██╔╝██║",
    "██║ ╚═╝ ██║",
    "╚═╝     ╚═╝",
  ],
  N: [
    "███╗   ██╗",
    "████╗  ██║",
    "██╔██╗ ██║",
    "██║╚██╗██║",
    "██║ ╚████║",
    "╚═╝  ╚═══╝",
  ],
  O: [
    " ██████╗ ",
    "██╔═══██╗",
    "██║   ██║",
    "██║   ██║",
    "╚██████╔╝",
    " ╚═════╝ ",
  ],
  P: ["██████╗ ", "██╔══██╗", "██████╔╝", "██╔═══╝ ", "██║     ", "╚═╝     "],
  Q: [
    " ██████╗ ",
    "██╔═══██╗",
    "██║   ██║",
    "██║▄▄ ██║",
    "╚██████╔╝",
    " ╚══▀▀═╝ ",
  ],
  R: ["██████╗ ", "██╔══██╗", "██████╔╝", "██╔══██╗", "██║  ██║", "╚═╝  ╚═╝"],
  S: ["███████╗", "██╔════╝", "███████╗", "╚════██║", "███████║", "╚══════╝"],
  T: [
    "████████╗",
    "╚══██╔══╝",
    "   ██║   ",
    "   ██║   ",
    "   ██║   ",
    "   ╚═╝   ",
  ],
  U: [
    "██╗   ██╗",
    "██║   ██║",
    "██║   ██║",
    "██║   ██║",
    "╚██████╔╝",
    " ╚═════╝ ",
  ],
  V: [
    "██╗   ██╗",
    "██║   ██║",
    "██║   ██║",
    "╚██╗ ██╔╝",
    " ╚████╔╝ ",
    "  ╚═══╝  ",
  ],
  W: [
    "██╗    ██╗",
    "██║    ██║",
    "██║ █╗ ██║",
    "██║███╗██║",
    "╚███╔███╔╝",
    " ╚══╝╚══╝ ",
  ],
  X: ["██╗  ██╗", "╚██╗██╔╝", " ╚███╔╝ ", " ██╔██╗ ", "██╔╝ ██╗", "╚═╝  ╚═╝"],
  Y: [
    "██╗   ██╗",
    "╚██╗ ██╔╝",
    " ╚████╔╝ ",
    "  ╚██╔╝  ",
    "   ██║   ",
    "   ╚═╝   ",
  ],
  Z: ["███████╗", "╚══███╔╝", "  ███╔╝ ", " ███╔╝  ", "███████╗", "╚══════╝"],
  " ": ["   ", "   ", "   ", "   ", "   ", "   "],
  ".": ["   ", "   ", "   ", "   ", "██╗", "╚═╝"],
  "-": ["       ", "       ", "█████╗ ", "╚════╝ ", "       ", "       "],
  _: ["        ", "        ", "        ", "        ", "███████╗", "╚══════╝"],
  "/": ["    ██╗", "   ██╔╝", "  ██╔╝ ", " ██╔╝  ", "██╔╝   ", "╚═╝    "],
  ":": ["   ", "██╗", "╚═╝", "██╗", "╚═╝", "   "],
  "!": ["██╗", "██║", "██║", "╚═╝", "██╗", "╚═╝"],
  "0": [
    " ██████╗ ",
    "██╔═████╗",
    "██║██╔██║",
    "████╔╝██║",
    "╚██████╔╝",
    " ╚═════╝ ",
  ],
  "1": [" ██╗", "███║", "╚██║", " ██║", " ██║", " ╚═╝"],
  "2": ["██████╗ ", "╚════██╗", " █████╔╝", "██╔═══╝ ", "███████╗", "╚══════╝"],
  "3": ["██████╗ ", "╚════██╗", " █████╔╝", " ╚═══██╗", "██████╔╝", "╚═════╝ "],
  "4": ["██╗  ██╗", "██║  ██║", "███████║", "╚════██║", "     ██║", "     ╚═╝"],
  "5": ["███████╗", "██╔════╝", "███████╗", "╚════██║", "███████║", "╚══════╝"],
  "6": [
    " ██████╗ ",
    "██╔════╝ ",
    "███████╗ ",
    "██╔═══██╗",
    "╚██████╔╝",
    " ╚═════╝ ",
  ],
  "7": ["███████╗", "╚════██║", "    ██╔╝", "   ██╔╝ ", "   ██║  ", "   ╚═╝  "],
  "8": [" █████╗ ", "██╔══██╗", "╚█████╔╝", "██╔══██╗", "╚█████╔╝", " ╚════╝ "],
  "9": [" █████╗ ", "██╔══██╗", "╚██████║", " ╚═══██║", " █████╔╝", " ╚════╝ "],
};

const MOBILE_ALPHABET: Record<string, string[]> = {
  A: ["░███░", "█░░░█", "█████", "█░░░█", "█░░░█"],
  B: ["████░", "█░░░█", "████░", "█░░░█", "████░"],
  C: ["░███░", "█░░░░", "█░░░░", "█░░░░", "░███░"],
  D: ["████░", "█░░░█", "█░░░█", "█░░░█", "████░"],
  E: ["█████", "█░░░░", "████░", "█░░░░", "█████"],
  F: ["█████", "█░░░░", "████░", "█░░░░", "█░░░░"],
  G: ["░███░", "█░░░░", "█░░██", "█░░░█", "░███░"],
  H: ["█░░░█", "█░░░█", "█████", "█░░░█", "█░░░█"],
  I: ["███", "░█░", "░█░", "░█░", "███"],
  J: ["░░███", "░░░█░", "░░░█░", "█░░█░", "░██░░"],
  K: ["█░░░█", "█░░█░", "███░░", "█░░█░", "█░░░█"],
  L: ["█░░░░", "█░░░░", "█░░░░", "█░░░░", "█████"],
  M: ["█░░░█", "██░██", "█░█░█", "█░░░█", "█░░░█"],
  N: ["█░░░█", "██░░█", "█░█░█", "█░░██", "█░░░█"],
  O: ["░███░", "█░░░█", "█░░░█", "█░░░█", "░███░"],
  P: ["████░", "█░░░█", "████░", "█░░░░", "█░░░░"],
  Q: ["░███░", "█░░░█", "█░░░█", "█░░█░", "░██░█"],
  R: ["████░", "█░░░█", "████░", "█░░█░", "█░░░█"],
  S: ["░████", "█░░░░", "░███░", "░░░░█", "████░"],
  T: ["█████", "░░█░░", "░░█░░", "░░█░░", "░░█░░"],
  U: ["█░░░█", "█░░░█", "█░░░█", "█░░░█", "░███░"],
  V: ["█░░░█", "█░░░█", "█░░░█", "░█░█░", "░░█░░"],
  W: ["█░░░█", "█░░░█", "█░█░█", "██░██", "█░░░█"],
  X: ["█░░░█", "░█░█░", "░░█░░", "░█░█░", "█░░░█"],
  Y: ["█░░░█", "░█░█░", "░░█░░", "░░█░░", "░░█░░"],
  Z: ["█████", "░░░█░", "░░█░░", "░█░░░", "█████"],
  " ": ["░░░", "░░░", "░░░", "░░░", "░░░"],
  "0": ["░███░", "█░░██", "█░█░█", "██░░█", "░███░"],
  "1": ["░██░", "███░", "░█░░", "░█░░", "███░"],
  "2": ["████░", "░░░░█", "░███░", "█░░░░", "█████"],
  "3": ["████░", "░░░░█", "░░██░", "░░░░█", "████░"],
  "4": ["█░░█░", "█░░█░", "█████", "░░░█░", "░░░█░"],
  "5": ["█████", "█░░░░", "████░", "░░░░█", "████░"],
  "6": ["░███░", "█░░░░", "████░", "█░░░█", "░███░"],
  "7": ["█████", "░░░█░", "░░█░░", "░█░░░", "█░░░░"],
  "8": ["░███░", "█░░░█", "░███░", "█░░░█", "░███░"],
  "9": ["░███░", "█░░░█", "░████", "░░░░█", "░███░"],
  "-": ["░░░░░", "░░░░░", "████░", "░░░░░", "░░░░░"],
  ".": ["░░", "░░", "░░", "░░", "░█"],
  "!": ["░█░", "░█░", "░█░", "░░░", "░█░"],
  ":": ["░░░", "░█░", "░░░", "░█░", "░░░"],
  "/": ["░░░░█", "░░░█░", "░░█░░", "░█░░░", "█░░░░"],
  _: ["░░░░░", "░░░░░", "░░░░░", "░░░░░", "█████"],
};

export type ArtOptions = {
  uppercase?: boolean;
  spacing?: number;
  lineSpacing?: number;
  maxWidth?: number;
  mobile?: boolean;
};

export function splitText(text: string, maxWidth: number): string[] {
  const words = text.split(" ");
  const lines: string[] = [];
  let currentLine = "";

  for (const word of words) {
    if (currentLine.length + word.length + 1 <= maxWidth) {
      currentLine += (currentLine ? " " : "") + word;
    } else {
      if (currentLine) lines.push(currentLine);
      currentLine = word;
    }
  }

  if (currentLine) lines.push(currentLine);
  return lines;
}

function generateSingleLine(
  text: string,
  alphabet: Record<string, string[]>,
  lineCount: number,
  uppercase: boolean,
  spacing: number,
): string {
  const normalizedText = uppercase ? text.toUpperCase() : text;
  const lines: string[] = Array(lineCount).fill("");
  const spacer = " ".repeat(spacing);

  for (const char of normalizedText) {
    const asciiChar = alphabet[char];

    if (asciiChar) {
      for (let i = 0; i < lineCount; i++) {
        lines[i] += asciiChar[i] + spacer;
      }
    } else {
      for (let i = 0; i < lineCount; i++) {
        lines[i] += alphabet[" "][i] + spacer;
      }
    }
  }

  return "\n" + lines.join("\n") + "\n";
}

export function generateAsciiArtText(
  text: string,
  options: ArtOptions = {},
): string {
  const {
    uppercase = true,
    spacing = options.mobile ? 1 : 0,
    lineSpacing = 1,
    maxWidth,
    mobile = false,
  } = options;

  const alphabet = mobile ? MOBILE_ALPHABET : ALPHABET;
  const lineCount = mobile ? 5 : 6;

  if (maxWidth) {
    const lines = splitText(text, maxWidth);
    const spacerLines = "\n".repeat(lineSpacing);

    return lines
      .map((line) =>
        generateSingleLine(line, alphabet, lineCount, uppercase, spacing),
      )
      .join(spacerLines);
  }

  return generateSingleLine(text, alphabet, lineCount, uppercase, spacing);
}
